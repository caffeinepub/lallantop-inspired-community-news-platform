{
  "kind": "build_request",
  "title": "Convert Global Nexus to a Progressive Web App (PWA)",
  "projectName": "Global Nexus",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-33",
      "text": "Create a `frontend/public/manifest.json` file with the following PWA configuration: name set to 'Global Nexus', short_name set to 'Global Nexus', description set to 'Multilingual community-driven news platform', start_url set to '/', display set to 'standalone', orientation set to 'portrait', theme_color set to '#1A6FBF', background_color set to '#1a1a1a', icons array referencing the generated 192×192 icon at '/assets/icons/icon-192x192.png' and the 512×512 icon at '/assets/icons/icon-512x512.png' with type 'image/png' and purpose 'any maskable'.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-recent-4",
          "msg-recent-5"
        ],
        "quotes": [
          "A manifest.json with Global Nexus branding (name, short_name, theme color #1A6FBF, background color #1a1a1a, standalone display mode)",
          "manifest.json with Global Nexus branding (name, theme color #1A6FBF, background #1a1a1a, standalone display)"
        ]
      },
      "acceptanceCriteria": [
        "frontend/public/manifest.json exists and is valid JSON",
        "name field is 'Global Nexus' and short_name is 'Global Nexus'",
        "display is 'standalone', theme_color is '#1A6FBF', background_color is '#1a1a1a'",
        "icons array references both 192×192 and 512×512 PNG icons with correct paths",
        "Browser DevTools Application > Manifest panel shows no errors"
      ]
    },
    {
      "id": "REQ-34",
      "text": "Update `frontend/index.html` to add all required PWA meta tags: (1) `<link rel='manifest' href='/manifest.json'>`, (2) `<meta name='theme-color' content='#1A6FBF'>`, (3) `<meta name='mobile-web-app-capable' content='yes'>`, (4) `<meta name='apple-mobile-web-app-capable' content='yes'>`, (5) `<meta name='apple-mobile-web-app-status-bar-style' content='default'>`, (6) `<meta name='apple-mobile-web-app-title' content='Global Nexus'>`, (7) `<link rel='apple-touch-icon' href='/assets/icons/icon-192x192.png'>`, (8) `<meta name='msapplication-TileColor' content='#1A6FBF'>`, (9) `<meta name='msapplication-TileImage' content='/assets/icons/icon-192x192.png'>`. Ensure the existing title tag 'Global Nexus' and favicon link remain unchanged.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-recent-4",
          "msg-recent-5"
        ],
        "quotes": [
          "PWA meta tags in index.html (viewport, theme-color, apple-touch-icon, apple-mobile-web-app-capable, ms-application-tile)"
        ]
      },
      "acceptanceCriteria": [
        "index.html contains <link rel='manifest' href='/manifest.json'>",
        "index.html contains theme-color meta tag with value #1A6FBF",
        "index.html contains apple-mobile-web-app-capable and apple-touch-icon meta tags",
        "Existing page title 'Global Nexus' and favicon remain unchanged",
        "Lighthouse PWA audit shows all installability criteria met"
      ]
    },
    {
      "id": "REQ-35",
      "text": "Create a service worker file at `frontend/public/sw.js` that implements a cache-first strategy for the app shell and static assets, and a network-first strategy for API calls to the ICP backend. The service worker must: (1) cache all static assets (HTML, CSS, JS, images, fonts) on install using a cache named 'global-nexus-v1', (2) serve cached assets when offline, (3) use network-first for any fetch requests to '/api' or ICP canister URLs so fresh content is always attempted first, (4) include an activate handler that clears old cache versions. Register the service worker in `frontend/index.html` via an inline script that calls `navigator.serviceWorker.register('/sw.js')` only if `'serviceWorker' in navigator`.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-recent-4",
          "msg-recent-5"
        ],
        "quotes": [
          "A service worker for offline caching and installability",
          "Service worker for offline caching of the app shell and static assets"
        ]
      },
      "acceptanceCriteria": [
        "frontend/public/sw.js exists with install, fetch, and activate event handlers",
        "Static assets are cached on service worker install",
        "App shell loads when network is offline (verified via DevTools Network > Offline mode)",
        "Service worker is registered in index.html",
        "Browser DevTools Application > Service Workers panel shows the worker as active"
      ]
    },
    {
      "id": "REQ-36",
      "text": "Place the two generated PWA app icon PNG files as static assets at `frontend/public/assets/icons/icon-192x192.png` and `frontend/public/assets/icons/icon-512x512.png`. These paths must exactly match the icon references in manifest.json and the apple-touch-icon meta tag in index.html.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-recent-4",
          "msg-recent-5"
        ],
        "quotes": [
          "App icon assets in the required PWA sizes",
          "app icons in standard sizes (192×192, 512×512)"
        ]
      },
      "acceptanceCriteria": [
        "frontend/public/assets/icons/icon-192x192.png exists and is a valid PNG",
        "frontend/public/assets/icons/icon-512x512.png exists and is a valid PNG",
        "Icon paths in manifest.json exactly match these file paths",
        "Icons render correctly when the app is installed on Android or iOS home screen"
      ]
    },
    {
      "id": "REQ-37",
      "text": "Add an in-app PWA install prompt banner to the frontend. Listen for the `beforeinstallprompt` browser event, stash the event, and display a dismissible banner at the bottom of the screen (fixed position, z-index above content) with the Global Nexus blue (#1A6FBF) background, white text reading 'Install Global Nexus — get the full app experience on your home screen', and an 'Install' button that calls `prompt()` on the stashed event. Also show a small 'Add to Home Screen' button in the top nav area visible on mobile. Once installed or dismissed, hide the banner and store the dismissed state in localStorage so it does not reappear. The prompt must not appear on desktop browsers where PWA install is not applicable.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-recent-4",
          "msg-recent-5"
        ],
        "quotes": [
          "Install prompt support so users on Android/iOS can add to home screen",
          "install prompt support for Android/iOS home screen installation"
        ]
      },
      "acceptanceCriteria": [
        "A dismissible install banner appears at the bottom of the screen on mobile when the PWA install criteria are met",
        "Clicking 'Install' triggers the native browser install prompt",
        "Banner disappears after installation or dismissal and does not reappear after page reload",
        "Banner does not appear on desktop browsers that do not support PWA install",
        "Banner styling uses #1A6FBF background with white text, consistent with Global Nexus branding"
      ]
    }
  ],
  "constraints": [
    "All existing features — news feed, citizen journalism, multimedia, dashboard, admin panel, role system, Hindi/English toggle, founder page, privacy/terms pages — must remain fully intact and functional",
    "Do not modify any files listed under frontend.immutablePaths",
    "PWA icons must be placed in frontend/public/assets/icons/ and referenced consistently across manifest.json and index.html",
    "Service worker must not interfere with Internet Identity authentication flows or ICP canister API calls",
    "Global Nexus branding (blue #1A6FBF, black #1a1a1a, logo) must be used throughout all PWA assets"
  ],
  "nonGoals": [
    "Native iOS or Android app development",
    "Backend changes — this is a frontend-only PWA conversion",
    "Changing any existing page layouts, color schemes, or feature logic",
    "Push notification support",
    "Background sync beyond basic offline caching"
  ],
  "imageRequirements": {
    "required": [
      "Square app icon with Global Nexus blue globe logo centered on a dark charcoal (#1a1a1a) background, bold white 'GN' monogram overlay, clean and minimal (icon-192x192.dim_192x192.png)",
      "Square app icon with Global Nexus blue globe logo centered on a dark charcoal (#1a1a1a) background, bold white 'GN' monogram overlay, clean and minimal, high resolution (icon-512x512.dim_512x512.png)"
    ],
    "edits": []
  }
}